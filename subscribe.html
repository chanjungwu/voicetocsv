<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨‚é–±å°ˆæ¥­ç‰ˆ - èªéŸ³æ§åˆ¶CSVä¿®æ”¹ç³»çµ±</title>
    <style>
        :root {
            /* ... (CSS å˜æ•°ä¸ä¹‹å‰ç›¸åŒ) ... */
        }
        [data-theme="light"] {
            /* ... (äº®è‰²ä¸»é¢˜ä¸ä¹‹å‰ç›¸åŒ) ... */
        }
        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            margin: 0; padding: 0; background-color: var(--bg-color); color: var(--primary-text);
            line-height: 1.7; transition: all 0.3s ease;
        }
        .container { max-width: 1100px; margin: 0 auto; padding: 20px; }
        .theme-toggle { position: fixed; top: 20px; right: 20px; background-color: var(--card-color); border: 2px solid var(--border-color); border-radius: 50px; padding: 10px 15px; cursor: pointer; font-size: 18px; transition: all 0.3s ease; z-index: 1000; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .theme-toggle:hover { transform: scale(1.05); }
        .back-button { margin-bottom: 30px; display: inline-block; }
        .back-button a { color: var(--accent-color); text-decoration: none; font-size: 16px; display: flex; align-items: center; gap: 8px; transition: all 0.3s ease; }
        .back-button a:hover { color: var(--primary-text); }
        .header { text-align: center; padding: 40px 0 60px 0; }
        .header h1 { font-size: 48px; margin-bottom: 20px; color: var(--primary-text); }
        .header .highlight { color: var(--accent-color); }
        .header p { font-size: 20px; color: var(--secondary-text); max-width: 600px; margin: 0 auto; }
        .pricing-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-bottom: 60px; }
        .pricing-card { background-color: var(--card-color); border: 2px solid var(--border-color); border-radius: 16px; padding: 40px 30px; position: relative; transition: all 0.3s ease; text-align: center; cursor: pointer; }
        .pricing-card:hover { transform: translateY(-8px); box-shadow: 0 15px 40px rgba(0,0,0,0.1); }
        .pricing-card.selected { border-color: var(--accent-color); background: linear-gradient(135deg, var(--card-color) 0%, rgba(255, 214, 10, 0.1) 100%); box-shadow: 0 15px 40px rgba(255, 193, 7, 0.2); transform: translateY(-8px); }
        .popular-badge { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, var(--accent-color) 0%, #ff9500 100%); color: var(--accent-text); padding: 8px 24px; border-radius: 25px; font-size: 14px; font-weight: bold; }
        .pricing-header h3 { font-size: 28px; margin-bottom: 20px; }
        .price { margin-bottom: 15px; }
        .price .amount { font-size: 56px; font-weight: bold; color: var(--accent-color); }
        .price .currency, .price .period { font-size: 20px; color: var(--secondary-text); }
        .savings { color: var(--success-color); font-size: 16px; font-weight: bold; margin-bottom: 25px; }
        .pricing-features { text-align: left; margin-bottom: 30px; }
        .feature-item { padding: 10px 0; display: flex; align-items: center; gap: 10px; }
        .selection-indicator { position: absolute; top: 15px; right: 15px; width: 24px; height: 24px; border: 2px solid var(--border-color); border-radius: 50%; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; }
        .pricing-card.selected .selection-indicator { background-color: var(--accent-color); border-color: var(--accent-color); color: var(--accent-text); font-weight: bold; }
        .apply-section { text-align: center; margin: 40px 0; opacity: 0; transition: all 0.5s ease; transform: translateY(20px); }
        .apply-section.visible { opacity: 1; transform: translateY(0); }
        .apply-button { background: linear-gradient(135deg, var(--accent-color) 0%, #ff9500 100%); color: var(--accent-text); padding: 18px 40px; border: none; border-radius: 50px; font-size: 18px; font-weight: bold; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 6px 20px rgba(255, 193, 7, 0.3); }
        .apply-button:hover { transform: translateY(-3px); }
        .apply-button:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .payment-details { max-height: 0; overflow: hidden; transition: all 0.5s ease-in-out; opacity: 0; }
        /* ã€æ’ç‰ˆä¿®æ­£ã€‘å¢åŠ å±•å¼€åçš„æœ€å¤§é«˜åº¦ */
        .payment-details.expanded { max-height: 1500px; opacity: 1; margin-top: 40px; }
        .payment-details-content { background: linear-gradient(135deg, var(--card-color) 0%, var(--bg-color) 100%); border: 2px solid var(--accent-color); border-radius: 16px; padding: 40px; max-width: 700px; margin: 0 auto; }
        .payment-details h3 { color: var(--accent-color); text-align: center; font-size: 28px; margin-bottom: 15px; }
        .payment-subtitle { text-align: center; color: var(--secondary-text); margin-bottom: 30px; font-size: 16px; }
        .bank-info-grid { display: grid; gap: 20px; margin-bottom: 30px; }
        .bank-info-item { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background-color: var(--card-color); border-radius: 8px; border: 1px solid var(--border-color); }
        .bank-info-item strong { color: var(--secondary-text); }
        .bank-info-item span { color: var(--primary-text); font-weight: bold; font-family: 'Consolas', monospace; }
        .selected-amount { color: var(--accent-color); font-size: 20px; }
        .warning-section { background: rgba(255, 193, 7, 0.1); border: 2px solid var(--accent-color); border-radius: 12px; padding: 30px; margin: 30px 0; text-align: center; }
        .warning-icon { font-size: 32px; margin-bottom: 15px; }
        .warning-section h4 { color: var(--accent-color); font-size: 20px; margin-bottom: 15px; }
        .warning-section p { color: var(--primary-text); font-size: 16px; margin: 0 auto 25px auto; max-width: 500px; }
        .notice-grid-compact { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; justify-content: center; }
        .notice-item-compact { text-align: center; padding: 20px 10px; background-color: var(--bg-color); border-radius: 8px; border: 1px solid var(--border-color); display: flex; flex-direction: column; align-items: center; }
        .notice-icon-small { font-size: 28px; margin-bottom: 10px; color: var(--accent-color); }
        .notice-content-compact strong { display: block; color: var(--primary-text); font-size: 14px; margin-bottom: 5px; }
        .notice-content-compact p { color: var(--secondary-text); font-size: 12px; margin: 0; line-height: 1.4; }
        .verification-steps { text-align: left; margin-top: 25px; padding: 20px; background-color: var(--bg-color); border: 1px dashed var(--accent-color); border-radius: 8px; }
        .verification-steps h5 { margin: 0 0 10px 0; font-size: 16px; }
        .verification-steps p { margin: 0; color: var(--secondary-text); font-size: 14px; line-height: 1.6; }
        .cta-section { text-align: center; margin: 60px 0; }
        .cta-section h3 { color: var(--accent-color); margin-bottom: 15px; }
        .cta-button { display: inline-block; background: linear-gradient(135deg, var(--accent-color) 0%, #ff9500 100%); color: var(--accent-text); padding: 20px 50px; border-radius: 50px; text-decoration: none; font-size: 20px; font-weight: bold; transition: all 0.3s ease; box-shadow: 0 6px 20px rgba(255, 193, 7, 0.3); }
        .cta-button:hover { transform: translateY(-3px); }
        .cta-subtitle { margin-top: 20px; color: var(--secondary-text); font-size: 16px; }
        .coupon-section { text-align: center; margin: -20px 0 40px 0; max-width: 400px; margin-left: auto; margin-right: auto; }
        .coupon-content { display: flex; gap: 10px; }
        #couponInput { flex-grow: 1; padding: 12px 15px; background-color: var(--input-bg); border: 1px solid var(--border-color); border-radius: 8px; color: var(--primary-text); font-size: 16px; }
        #couponButton { padding: 12px 25px; background-color: var(--success-color); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; }
        .coupon-message { margin-top: 10px; font-size: 14px; height: 20px; }
        .coupon-message.success { color: var(--success-color); }
        .coupon-message.error { color: var(--error-color); }
        @media (max-width: 768px) {
            .header h1 { font-size: 36px; }
            .pricing-grid { grid-template-columns: 1fr; }
            .notice-grid-compact { grid-template-columns: repeat(2, 1fr); }
            .payment-details-content { padding: 25px; }
            .cta-button { padding: 15px 35px; font-size: 18px; }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="åˆ‡æ›æ˜æš—ä¸»é¡Œ">ğŸŒ™</button>

    <div class="container">
        <div class="back-button">
            <a href="javascript:window.history.back();">â† è¿”å›ä¸»é </a>
        </div>

        <header class="header">
            <h1>é¸æ“‡æ‚¨çš„<span class="highlight">å°ˆæ¥­ç‰ˆ</span>æ–¹æ¡ˆ</h1>
            <p>è§£é–å®Œæ•´çš„èªéŸ³æ§åˆ¶åŠŸèƒ½ï¼Œè®“æ•ˆç‡ç¿»å€ï¼é¸æ“‡æœ€é©åˆæ‚¨çš„è¨‚é–±æ–¹æ¡ˆï¼Œç«‹å³é–‹å§‹é«”é©—ã€‚</p>
        </header>

        <section class="pricing-section">
            <div class="pricing-grid">
                <div class="pricing-card" data-plan="monthly" onclick="selectPlan(this)">
                    <div class="selection-indicator">âœ“</div>
                    <div class="pricing-header"><h3>æœˆè²»æ–¹æ¡ˆ</h3><div class="price"><span class="currency">NT$</span><span class="amount">50</span><span class="period">/æœˆ</span></div></div>
                    <div class="pricing-features">
                        <div class="feature-item"><span>âœ“</span><span>å®Œæ•´èªéŸ³è­˜åˆ¥åŠŸèƒ½</span></div>
                        <div class="feature-item"><span>âœ“</span><span>ç„¡é™åˆ¶CSVæª”æ¡ˆæ•¸é‡</span></div>
                        <div class="feature-item"><span>âœ“</span><span>30å¤©ä½¿ç”¨æœŸé™</span></div>
                        <div class="feature-item"><span>âœ“</span><span>åŸºç¤æŠ€è¡“æ”¯æ´</span></div>
                    </div>
                </div>
                <div class="pricing-card featured" data-plan="halfyear" onclick="selectPlan(this)">
                    <div class="popular-badge">æœ€å—æ­¡è¿</div><div class="selection-indicator">âœ“</div>
                    <div class="pricing-header"><h3>åŠå¹´æ–¹æ¡ˆ</h3><div class="price"><span class="currency">NT$</span><span class="amount">285</span><span class="period">/6å€‹æœˆ</span></div><div class="savings">çœä¸‹ NT$15 ğŸ’°</div></div>
                    <div class="pricing-features">
                        <div class="feature-item"><span>âœ“</span><span>å®Œæ•´èªéŸ³è­˜åˆ¥åŠŸèƒ½</span></div>
                        <div class="feature-item"><span>âœ“</span><span>ç„¡é™åˆ¶CSVæª”æ¡ˆæ•¸é‡</span></div>
                        <div class="feature-item"><span>âœ“</span><span>180å¤©ä½¿ç”¨æœŸé™</span></div>
                        <div class="feature-item"><span>âœ“</span><span>å„ªå…ˆå®¢æœæ”¯æ´</span></div>
                        <div class="feature-item"><span>âœ“</span><span>åŠŸèƒ½æ›´æ–°å„ªå…ˆé«”é©—</span></div>
                    </div>
                </div>
                <div class="pricing-card" data-plan="yearly" onclick="selectPlan(this)">
                    <div class="selection-indicator">âœ“</div>
                    <div class="pricing-header"><h3>å¹´è²»æ–¹æ¡ˆ</h3><div class="price"><span class="currency">NT$</span><span class="amount">540</span><span class="period">/å¹´</span></div><div class="savings">çœä¸‹ NT$60 ğŸ¯</div></div>
                    <div class="pricing-features">
                        <div class="feature-item"><span>âœ“</span><span>å®Œæ•´èªéŸ³è­˜åˆ¥åŠŸèƒ½</span></div>
                        <div class="feature-item"><span>âœ“</span><span>ç„¡é™åˆ¶CSVæª”æ¡ˆæ•¸é‡</span></div>
                        <div class="feature-item"><span>âœ“</span><span>365å¤©ä½¿ç”¨æœŸé™</span></div>
                        <div class="feature-item"><span>âœ“</span><span>å„ªå…ˆå®¢æœæ”¯æ´</span></div>
                        <div class="feature-item"><span>âœ“</span><span>å…è²»åŠŸèƒ½æ›´æ–°</span></div>
                        <div class="feature-item"><span>âœ“</span><span>å°ˆå±¬å®¢æœå°ˆç·š</span></div>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="coupon-section" id="couponSection">
            <div class="coupon-content">
                <input type="text" id="couponInput" placeholder="æœ‰å„ªæƒ ç¢¼å—ï¼Ÿè«‹åœ¨æ­¤è¼¸å…¥">
                <button onclick="applyCoupon()" id="couponButton">å¥—ç”¨</button>
            </div>
            <p id="couponMessage" class="coupon-message"></p>
        </section>

        <section class="apply-section" id="applySection">
            <div class="apply-section-content">
                 <button class="apply-button" onclick="showPaymentDetails();" disabled id="applyButton">
                    è«‹å…ˆé¸æ“‡æ–¹æ¡ˆ
                </button>
            </div>
        </section>

        <section class="payment-details" id="paymentDetails">
            <div class="payment-details-content">
                <h3>ğŸ’³ æ­¥é©Ÿä¸€ï¼šå®ŒæˆåŒ¯æ¬¾</h3>
                <p class="payment-subtitle">è«‹ä¾ç…§ä»¥ä¸‹è³‡è¨Šé€²è¡ŒåŒ¯æ¬¾</p>
                <div class="bank-info-grid">
                    <div class="bank-info-item"><strong>éŠ€è¡Œä»£è™Ÿï¼š</strong><span>809</span></div>
                    <div class="bank-info-item"><strong>åŒ¯æ¬¾å¸³è™Ÿï¼š</strong><span>0060108000009079</span></div>
                    <div class="bank-info-item"><strong>åŒ¯æ¬¾é‡‘é¡ï¼š</strong><span class="selected-amount" id="selectedAmount">è«‹é¸æ“‡æ–¹æ¡ˆ</span></div>
                </div>
                <div class="warning-section">
                    <div class="warning-icon">âš ï¸</div>
                    <h4>æ­¥é©ŸäºŒï¼šè¨˜ä¸‹é—œéµè³‡è¨Š</h4>
                    <p>ç‚ºäº†é †åˆ©å•Ÿç”¨ï¼Œè«‹å‹™å¿…è¨˜ä¸‹æ‚¨åŒ¯æ¬¾æ™‚ï¼ŒéŠ€è¡Œé é¢é¡¯ç¤ºçš„ä»¥ä¸‹äº”é …è³‡è¨Šï¼š</p>
                    <div class="notice-grid-compact">
                        <div class="notice-item-compact">
                            <div class="notice-icon-small">ğŸ’°</div>
                            <div class="notice-content-compact"><strong>åŒ¯æ¬¾é‡‘é¡</strong><p>æ‚¨å‰›æ‰åŒ¯å‡ºçš„ç¢ºåˆ‡æ•¸å­—</p></div>
                        </div>
                        <div class="notice-item-compact">
                            <div class="notice-icon-small">ğŸ•</div>
                            <div class="notice-content-compact"><strong>åŒ¯æ¬¾æ™‚é–“</strong><p>ç²¾ç¢ºåˆ°åˆ†é˜<br>æ ¼å¼ï¼š14:30</p></div>
                        </div>
                        <div class="notice-item-compact">
                            <div class="notice-icon-small">ğŸ¦</div>
                            <div class="notice-content-compact"><strong>å¸³è™Ÿå¾Œäº”ç¢¼</strong><p>æ‚¨çš„åŒ¯æ¬¾å¸³è™Ÿæœ«5ç¢¼</p></div>
                        </div>
                        <div class="notice-item-compact">
                            <div class="notice-icon-small">ğŸŸï¸</div>
                            <div class="notice-content-compact"><strong>å„ªæƒ ç¢¼</strong><p>å¦‚æœæ‚¨æœ‰ä½¿ç”¨<br>(å¤§å°å¯«çš†å¯)</p></div>
                        </div>
                        <div class="notice-item-compact">
                            <div class="notice-icon-small">ğŸ“§</div>
                            <div class="notice-content-compact"><strong>æ‚¨çš„ Email</strong><p>ç”¨æ–¼æ¥æ”¶å•Ÿç”¨ç¢¼å‚™ä»½</p></div>
                        </div>
                    </div>
                     <div class="verification-steps">
                        <h5>ä¸‹ä¸€æ­¥ï¼Ÿé©—è­‰æµç¨‹èªªæ˜</h5>
                        <p>
                            å®ŒæˆåŒ¯æ¬¾å¾Œï¼Œè«‹é»æ“Šä¸‹æ–¹çš„ã€Œ<b>åŒ¯æ¬¾å®Œæˆï¼Œç«‹å³é–‹é€šè»Ÿé«”</b>ã€æŒ‰éˆ•ã€‚åœ¨é©—è­‰é é¢ï¼Œåªéœ€è¼¸å…¥æ‚¨å‰›å‰›è¨˜ä¸‹çš„è³‡è¨Šï¼Œç³»çµ±å°±æœƒè‡ªå‹•æ¯”å°ä¸¦ç«‹å³ç™¼æ”¾æ‚¨çš„å°ˆå±¬å•Ÿç”¨ç¢¼ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <section class="cta-section" id="finalCtaSection" style="display: none;">
            <h3>æ­¥é©Ÿä¸‰ï¼šé»æˆ‘å•Ÿç”¨</h3>
            <a href="verify.html" target="_blank" class="cta-button">åŒ¯æ¬¾å®Œæˆï¼Œç«‹å³é–‹é€šè»Ÿé«”</a>
            <p class="cta-subtitle">é»æ“Šä¸Šæ–¹æŒ‰éˆ•ï¼Œè¼¸å…¥æ‚¨è¨˜ä¸‹çš„è³‡è¨Šä¾†ç²å–å•Ÿç”¨ç¢¼ã€‚</p>
        </section>
    </div>

    <script>
        const originalPrices = { monthly: 50, halfyear: 285, yearly: 540 };
        const discountedPrices = { monthly: 45, halfyear: 255, yearly: 485 };
        let activeCoupon = null;
        let selectedPlan = null;

        function updatePriceDisplay(prices) {
            document.querySelectorAll('.pricing-card').forEach(card => {
                const plan = card.dataset.plan;
                if (plan) { card.querySelector('.amount').textContent = prices[plan]; }
            });
            if (selectedPlan) {
                selectPlan(document.querySelector(`.pricing-card[data-plan='${selectedPlan.plan}']`));
            }
        }

        async function applyCoupon() {
            const couponInput = document.getElementById('couponInput');
            const couponMessage = document.getElementById('couponMessage');
            const couponButton = document.getElementById('couponButton');
            const couponCode = couponInput.value.trim().toUpperCase();

            if (!couponCode) {
                couponMessage.textContent = 'è«‹è¼¸å…¥å„ªæƒ ç¢¼';
                couponMessage.className = 'coupon-message error';
                return;
            }

            couponButton.textContent = 'é©—è­‰ä¸­...';
            couponButton.disabled = true;

            try {
                const response = await fetch('/api/check-coupon', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ coupon: couponCode })
                });
                const data = await response.json();
                if (response.ok) {
                    activeCoupon = couponCode;
                    couponMessage.textContent = `âœ… å„ªæƒ ç¢¼ "${activeCoupon}" å·²æˆåŠŸå¥—ç”¨ï¼`;
                    couponMessage.className = 'coupon-message success';
                    couponInput.disabled = true;
                    couponButton.style.display = 'none';
                    updatePriceDisplay(discountedPrices);
                } else { throw new Error(data.error); }
            } catch (error) {
                couponMessage.textContent = `âŒ ${error.message}`;
                couponMessage.className = 'coupon-message error';
            } finally {
                couponButton.textContent = 'å¥—ç”¨';
                couponButton.disabled = false;
            }
        }
        
        function selectPlan(card) {
            document.querySelectorAll('.pricing-card').forEach(c => c.classList.remove('selected'));
            card.classList.add('selected');
            const currentPrices = activeCoupon ? discountedPrices : originalPrices;
            const plan = card.dataset.plan;
            selectedPlan = {
                plan: plan,
                amount: currentPrices[plan],
                days: card.dataset.days,
                coupon: activeCoupon
            };
            const applyButton = document.getElementById('applyButton');
            applyButton.disabled = false;
            applyButton.textContent = `ç”³è«‹è¨‚é–± - NT$${selectedPlan.amount}`;
            document.getElementById('applySection').classList.add('visible');
            document.getElementById('paymentDetails').classList.remove('expanded');
        }

        function showPaymentDetails() {
            if (!selectedPlan) return;
            const paymentDetails = document.getElementById('paymentDetails');
            document.getElementById('selectedAmount').textContent = `NT$ ${selectedPlan.amount}`;
            paymentDetails.classList.add('expanded');
            document.getElementById('finalCtaSection').style.display = 'block';
            setTimeout(() => {
                paymentDetails.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        }

        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            if (body.getAttribute('data-theme') === 'light') {
                body.removeAttribute('data-theme');
                themeToggle.textContent = 'ğŸŒ™';
                localStorage.setItem('theme', 'dark');
            } else {
                body.setAttribute('data-theme', 'light');
                themeToggle.textContent = 'â˜€ï¸';
                localStorage.setItem('theme', 'light');
            }
        }
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            const themeToggle = document.getElementById('themeToggle');
            if (savedTheme === 'light') {
                document.body.setAttribute('data-theme', 'light');
                themeToggle.textContent = 'â˜€ï¸';
                themeToggle.title = 'åˆ‡æ›åˆ°æ·±è‰²ä¸»é¡Œ';
            } else {
                themeToggle.textContent = 'ğŸŒ™';
                themeToggle.title = 'åˆ‡æ›åˆ°æ˜äº®ä¸»é¡Œ';
            }
        });
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) { target.scrollIntoView({ behavior: 'smooth', block: 'start' }); }
            });
        });
    </script>
</body>
</html>